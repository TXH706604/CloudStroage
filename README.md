# 内网云存储系统

一个简单易用的局域网文件共享系统，支持多设备文件互传。

## ✨ 功能特性

- 📤 **文件上传** - 支持多文件同时上传，支持所有文件类型
- 📥 **文件下载** - 一键下载任意文件
- 🔍 **文件搜索** - 快速查找文件
- 🗑️ **文件删除** - 管理云端文件
- 🌐 **跨设备共享** - 内网所有设备可互相访问
- 📊 **文件信息** - 显示文件大小和上传时间
- 📱 **响应式设计** - 支持桌面和移动设备
- 🔓 **全类型支持** - 无文件类型限制，支持上传任意文件
- 🇨🇳 **中文支持** - 完美支持中文文件名和特殊字符

## 🚀 快速开始

### 前置要求

- Python 3.6 或更高版本
- 现代浏览器（Chrome、Firefox、Edge 等）

### 安装步骤

1. **下载项目**
   ```bash
   git clone <仓库地址>
   cd CloudStroage
   ```

2. **双击启动**
   - 直接双击运行 `start.bat` 文件
   - 首次运行会自动安装依赖（Flask）

3. **访问系统**
   - 本机访问：`http://localhost:10000`
   - 局域网访问：`http://<你的IP地址>:10000`

## 📖 使用说明

### 上传文件

1. 点击"上传文件"按钮
2. 选择要上传的文件（支持多选）
3. 等待上传完成
4. 文件会自动同步到所有设备

### 下载文件

1. 在文件列表中找到目标文件
2. 点击"下载"按钮

### 删除文件

1. 在文件列表中找到目标文件
2. 点击"删除"按钮
3. 确认删除操作（删除后所有设备都无法再访问该文件）

### 搜索文件

- 在搜索框中输入文件名
- 列表会实时过滤显示匹配的文件

## 🔧 配置说明

### 修改共享文件夹路径

编辑 `server.py` 文件，修改 `CONFIG` 中的 `UPLOAD_FOLDER`：

```python
CONFIG = {
    'UPLOAD_FOLDER': 'D:\\我的共享文件夹',  # 修改为你想要的路径
    'MAX_FILE_SIZE': 500 * 1024 * 1024,  # 最大文件大小（500MB）
    'ALLOWED_EXTENSIONS': None  # None 表示允许所有文件类型，或指定扩展名如 {'jpg', 'png', 'pdf'}
}
```

### 限制文件类型（可选）

如果只想允许特定类型的文件，可以修改 `ALLOWED_EXTENSIONS`：

```python
CONFIG = {
    'ALLOWED_EXTENSIONS': {'jpg', 'png', 'gif', 'pdf'}  # 只允许图片和 PDF
}
```

设置为 `None` 则允许所有文件类型。

### 修改端口

编辑 `server.py` 文件，修改 `main()` 函数中的端口：

```python
def main():
    port = 8080  # 修改为你想要的端口
    # ...
```

### 修改最大文件大小

编辑 `server.py` 文件：

```python
CONFIG = {
    'MAX_FILE_SIZE': 1024 * 1024 * 1024,  # 1GB
    # ...
}
```

## 🌐 局域网访问

### 获取本机 IP

启动服务器后，控制台会显示：
```
📍 本地访问:   http://localhost:10000
🌐 局域网访问: http://192.168.1.100:10000
```

### 其他设备访问

1. 确保所有设备连接到同一个网络
2. 在其他设备的浏览器中输入局域网地址
3. 即可访问和共享文件

### 防火墙设置

如果无法访问，请检查防火墙设置：

**Windows:**
1. 打开"控制面板" → "Windows Defender 防火墙"
2. 点击"允许应用或功能通过 Windows Defender 防火墙"
3. 找到 Python，勾选"专用网络"

**Mac/Linux:**
```bash
# 开放端口 10000
sudo ufw allow 10000
```

## 📁 文件结构

```
CloudStroage/
├── server.py           # 后端服务器（Flask）
├── index.html          # 前端页面
├── start.bat           # Windows 启动脚本
├── config.py           # 配置文件
├── requirements.txt    # 依赖列表
├── README.md           # 说明文档
└── shared_files/       # 共享文件夹（自动创建）
```

## 🔌 API 接口

### 获取文件列表
```
GET /api/files
```

### 上传文件
```
POST /api/upload
Content-Type: multipart/form-data
参数: file (文件)
```

### 下载文件
```
GET /api/download/<filename>
```

### 删除文件
```
DELETE /api/delete
Content-Type: application/json
Body: { "filename": "文件名" }
```

### 获取配置
```
GET /api/config
```

### 获取存储信息
```
GET /api/storage
```

## ⚠️ 注意事项

1. **网络安全**
   - 本系统仅适用于内网环境
   - 不要暴露到公网
   - 建议设置密码保护（需要二次开发）
   - 支持所有文件类型上传，请谨慎使用

2. **文件大小限制**
   - 默认最大文件大小：500MB
   - 可在配置中修改
   - 超大文件可能导致性能问题

3. **并发访问**
   - 支持多设备同时访问
   - 建议同时上传文件数不超过 10 个

4. **数据安全**
   - 建议定期备份 `shared_files` 文件夹
   - 删除操作不可恢复

## 🛠️ 故障排除

### 端口被占用

**错误信息：** `OSError: [WinError 10048]`

**解决方法：**
1. 查找占用端口的进程：
   ```cmd
   netstat -ano | findstr :10000
   ```
2. 结束进程或修改 `server.py` 中的端口

### 无法访问局域网

**可能原因：**
1. 防火墙阻止了连接
2. 设备不在同一个网络
3. IP 地址错误

**解决方法：**
1. 检查防火墙设置
2. 确认所有设备连接到同一 Wi-Fi/网络
3. 使用 `ipconfig`（Windows）或 `ifconfig`（Mac/Linux）查看本机 IP

### 上传失败

**可能原因：**
1. 文件大小超过限制
2. 文件类型不支持
3. 磁盘空间不足

**解决方法：**
1. 检查文件大小
2. 修改配置中的 `ALLOWED_EXTENSIONS`
3. 清理磁盘空间

## 📝 更新日志

### v2.0.0 (最新版本)
- ✅ 添加后端服务器支持
- ✅ 实现跨设备文件共享
- ✅ 文件存储在服务器而非浏览器
- ✅ 支持大文件上传（500MB）
- ✅ 优化性能和用户体验

### v1.0.0
- ✅ 基础文件上传/下载功能
- ✅ 文件搜索和删除功能
- ✅ 响应式设计

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📮 联系方式

如有问题或建议，请提交 Issue。
